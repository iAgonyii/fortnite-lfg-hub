@model BusinessLayer.Profile
@using Fortnite_LFG_Hub.ViewModels
@using BusinessLayer.Logic
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor

@{
    ViewData["Title"] = "Profile";
}

<h1>@Model.Username</h1> <!-- Picture should come here too -->
<br />
@{
    if (Model.Region != BusinessLayer.Regions._)
    {
        <h3>@Model.Region.ToString()</h3>
    }
    if (Model.Looking)
    {
        <h3 color="green">LFG</h3>
    }
    else
    {
        <h3 color="red">NOT LFG</h3>
    }
}
<br />

@foreach (var achievement in Model.Achievements)
{
    <h4>#@achievement.Rank</h4>
    string replacedEvent = achievement.Event.ToString().Replace("_", " ");
    <h4>@replacedEvent</h4>
    <br />
}
@{
    if (!string.IsNullOrWhiteSpace(Model.FreeText))
    {
        <h5>@Model.FreeText</h5>
    }
    else
    {
        <span>This user has not shared any additional information</span>
    }
    <br />
    if (!string.IsNullOrWhiteSpace(Model.SocialURL))
    {
    <a href="@Model.SocialURL"><h5>Twitter</h5></a>
    }
    else
    {
        <span>This user has not linked a social platform</span>
    }
}
<br />
@{

    if (HttpContextAccessor.HttpContext.Session != null)
    {
        if (HttpContextAccessor.HttpContext.Session.Get<int>("UserId") != 0)
        {
        <br />
            if (HttpContextAccessor.HttpContext.Session.Get<int>("UserId") == Model.UserId)
            {
            <a type="button" asp-controller="Profiles" asp-action="EditProfile" asp-route-id="@Model.UserId">Edit Profile</a>
            <br />
            }

            CommentViewModel comment = new CommentViewModel();
            <partial name="Comment" model="comment"/>
        }
    }
}
<br />
@{
    foreach(var comment in Model.Comments)
    {
        ProfileLogic logic = new ProfileLogic();
        string username = logic.GetUsernameForId(comment.SourceUser);
        <div class="list-group-item">
            <span><a asp-controller="Profiles" asp-action="Profile" asp-route-id="@comment.SourceUser">@username</a> | @comment.TimePosted</span>
            <p>@comment.CommentText</p>
        </div>
        <br />
    }
}



